"use strict";function _slicedToArray(t,e){return _arrayWithHoles(t)||_iterableToArrayLimit(t,e)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function _iterableToArrayLimit(t,e){var r=[],n=!0,a=!1,i=void 0;try{for(var o,l=t[Symbol.iterator]();!(n=(o=l.next()).done)&&(r.push(o.value),!e||r.length!==e);n=!0);}catch(t){a=!0,i=t}finally{try{n||null==l.return||l.return()}finally{if(a)throw i}}return r}function _arrayWithHoles(t){if(Array.isArray(t))return t}function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),t}!function(t){var e=function(){function r(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"";if(_classCallCheck(this,r),!t||"object"!==_typeof(t)||Array.isArray(t))throw new Error("[EO TranslatorJS] Invalid dictionary object");if("string"!=typeof e)throw new Error("[EO TranslatorJS] Invalid language key, expected “string” by recieved “".concat(_typeof(e),"”"));this.dictionary=t||{},this.language=e||document.documentElement.lang||"en"}return _createClass(r,[{key:"dictionary",set:function(t){if(!t||"object"!==_typeof(t)||Array.isArray(t))throw new Error("[EO TranslatorJS] Invalid dictionary object");this._dictionary=t},get:function(){return this._dictionary}},{key:"language",set:function(t){if("string"!=typeof t)throw new Error("[EO TranslatorJS] Invalid language key, expected “string” by recieved “".concat(_typeof(t),"”"));this._language=t},get:function(){return this._language}},{key:"languages",get:function(){return this.dictionary?Object.keys(this.dictionary):[]}}]),_createClass(r,[{key:"translate",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=e.lang||this.language,n=e.fallback||t,a=e.params||{},i=t.split(".").filter(function(t){return 0<t.length});if(!this.isValidLanguage(r))throw new Error("[EO TranslatorJS] Invalid target language “".concat(r,"”"));var o,l,s=this.dictionary.hasOwnProperty(this.language);return s&&(s=1<i.length?function(t,e,r){var n=t[e],a=!0,i=!1,o=void 0;try{for(var l,s=r[Symbol.iterator]();!(a=(l=s.next()).done);a=!0){var c=l.value;if(!(n=n[c]||void 0))break}}catch(t){i=!0,o=t}finally{try{a||null==s.return||s.return()}finally{if(i)throw o}}return n}(this.dictionary,r,i):this.dictionary[r][t]),s?(o=s,l=a,Object.keys(l).forEach(function(t){var e=new RegExp("{".concat(t,"}"),"g");o=o.replace(e,l[t])}),o):n}},{key:"translateElement",value:function(t,e){if(t){var r=e||this.language,n=t.attributes["eo-translator"].value||t.textContent||t.innerText||t.innerHTML,a=(t.attributes["eo-translator-fallback"]||{value:n}).value,i=JSON.parse((t.attributes["eo-translator-params"]||{value:"{}"}).value)||{};t.textContent=this.translate(n,{lang:r,fallback:a,params:i})}}},{key:"translateDOM",value:function(t,e){var r=this,n=e||this.language;(t||document).querySelectorAll("[eo-translator]").forEach(function(t){return r.translateElement(t,n)})}},{key:"add",value:function(t,e,r){var n=e.split(".").filter(function(t){return 0<t.length}),a=n.pop();this.dictionary.hasOwnProperty(t)||(this.dictionary[t]={});var i=this.dictionary[t];if(0<n.length)for(var o=Object.entries(n),l=0;l<o.length;l++){var s=_slicedToArray(o[l],2),c=s[0],u=s[1];if(!(i=i[u]||(i[u]={})))break;parseInt(c)===n.length-1&&(i[a]=r)}else i[e]=r}},{key:"remove",value:function(t,e){var r=e.split(".").filter(function(t){return 0<t.length}),n=r.pop();if(this.dictionary.hasOwnProperty(t)){var a=this.dictionary[t];if(0<r.length)for(var i=Object.entries(r),o=0;o<i.length;o++){var l=_slicedToArray(i[o],2),s=l[0];if(!(a=a[l[1]]))break;parseInt(s)===r.length-1&&delete a[n]}else delete a[e]}}},{key:"isValidLanguage",value:function(t){return this.dictionary.hasOwnProperty(t)}}]),r}();"undefined"!=typeof exports?module.exports=e:t.EOTranslator=e}("undefined"!=typeof window?window:void 0);